____________________________________________________________________________________
RMJ000343.8+100123.8

http://irtfweb.ifa.hawaii.edu/~spex/parrefrac/?observatory=Keck2&hahrs=-4&hamin=00&hasec=00&decdeg=10&decmin=01&decsec=00&bar_pressure=615&water_vapor=2&temp_c=0&submit=Submit

Parallactic Angle =   -72.7998047      or    107.200195      or    287.200195      degrees 
  

python3 deimosfootprint.py [ra] [dec] [PA] > mask1.reg

python3 deimosfootprint.py "00:03:50.5380387 +10:02:06.249290" 40 > mask1.reg
python3 deimosfootprint.py "00:03:52.2653125 +10:01:40.859374" 40 > mask1.reg
python3 deimosfootprint.py "00:03:52.2653125 +10:01:40.859374" 220 > mask1_1.reg
python3 deimosfootprint.py "00:03:52.6853271 +10:04:00.687612" -140 > mask1_2.reg
python3 deimosfootprint.py "00:04:02.1329928 +10:03:27.409098" 40 > 0003/mask1_3.reg

Load SDSS catalog and apply filter
	(${rmag}<17 && ${rmag}>15 && ${cl}==6) {draw}
	x check SDSS navigator!
		x the guide star is too bright according to PS.
	for alignment stars:
		(${rmag}<20 && ${rmag}>15 && ${cl}==6) {draw}
	x Do galaxies work as alignment and guide? No




Export filtered catalog.

PS catalog download
	00:03:52.6853271 +10:04:00.687612
	x Stacked or mean catalog?
		x I think it should be stacked. Mean returns too many entries!
			x Stacked has gaps. It has to be mean.
	Remember to establish conditions, especially nDetections>=2
		Also rMeanKronMag>-990
			THESE ARE VERY IMPORTANT. Even if it results in unmatched sources, we don't want to target spurious detections!!

MAST zphot SQL query
	see jupyter notebook


prioritize.py
	use jupyter notebook to calculate positions in deg of the mask center.
	export ra,dec,rmag of align/guide stars directly from Aladin
	x only one guide star? Yes.
	x are other slit_pa values acceptable? Output has 3 different values.
		x Between -90 and 90 deg.

Preparing known redshifts
	NED cone search 10' radius
	Redshift Flag: like 's%' (selects spectroscopic) or sls (better b/c only uses spectral lines (no weird methods))

x 2nd mask: make file like archivalz from output to exclude from target list
x make target catalog for aladin instead of region file
x make catalog for archivalz
x make catalogs for selected and non-selected
- implement improvements suggested by David in the google doc
	- implement penalty for off-axis
x bogus selected targets
	x check PS catalogs (photo and zphoto)
		x bogus targets have low nDetections
	x remove (by hand?)
		x maybe using nDetections would work
			x use nDetections=10
x how to get full PS catalog in the region?
	x use api in jupyter notebook
x ask for output folder instead of redirecting output.
x version control
x dispersion direction?
	x always perpendicular to maskPA (doesn't depend on slitPA)
x how to put ps_api library in path?
x implement exclude_manually (input file already changed)

*******
2nd attempt with different PA

python3 deimosfootprint.py "00:03:48.7225972 +10:01:48.665376" 150 > 0003/mask2_1.reg
python3 deimosfootprint.py "00:03:48.7225972 +10:01:48.665376" -30 > 0003/mask2_2.reg
python3 deimosfootprint.py "00:03:45.5025197 +10:04:27.708330" -30 > 0003/2/mask2_3.reg


python3 prioritize.py file.json > 2/targets.txt
python3 prioritize.py 2/file.json > 2/targets.txt



*******
Starting over on RMJ0003/

use david's archivalz.txt file
	convert david's output into csv

phot_1.csv: nDetections>1, rmag>-990
phot_2.csv: nDetections unconstrained, rmag>-990
phot_3.csv (?): unconstrained
phot.cvs: nDetections>10

MASK1
python3 deimosfootprint.py "00:03:48.8888534 +10:04:10.737999" -140 > RMJ0003/1/mask1.reg
python3 prioritize.py RMJ0003 1


MASK2
python3 deimosfootprint.py "00:03:50.0443707 +10:04:22.110113" -140 > RMJ0003/2/mask1.reg
change 2/input.json to read output file
python3 prioritize.py RMJ0003 2


grep -v diamond RMJ0003A.reg >RMJ0003A-safe.reg


____________________________________________________________________________________
RMJ2321 (I'll be using Faik's region file to place the mask where he wants.)

Run the SpeX PARALLACTIC ANGLE CALCULATOR.
Parallactic Angle =   -85.3380966      or    94.6619034      or    274.661896      degrees

Create a mask region somewhere (RA and Dec can be the nominal coordinates for the cluster)  by typing: 
python3 deimosfootprint.py "23:21:09.5327035 +29:12:52.921937" 45.5 > RMJ2321/1/mask1.reg. Load the region file into Aladin. On the stack panel (right-hand side), click on the Drawing plane and select all objects. Now you can move the mask to the position you want. The cross in the middle of a chip gap is the central position; click on it to get the new coordinates. Now create a new mask. You can try adjusting the angle as well.
python3 deimosfootprint.py "23:21:08.3381708 +29:13:00.035871" 45 > RMJ2321/1/mask1.reg
Load the new mask into Aladin and inspect it.

python3 prioritize.py RMJ2321 1

process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ2321/1/dsim/

python3 prioritize.py RMJ2321 2
	changed the input file to 





