____________________________________________________________________________________
RMJ000343.8+100123.8

http://irtfweb.ifa.hawaii.edu/~spex/parrefrac/?observatory=Keck2&hahrs=-4&hamin=00&hasec=00&decdeg=10&decmin=01&decsec=00&bar_pressure=615&water_vapor=2&temp_c=0&submit=Submit

Parallactic Angle =   -72.7998047      or    107.200195      or    287.200195      degrees 
  

python3 deimosfootprint.py [ra] [dec] [PA] > mask1.reg

python3 deimosfootprint.py "00:03:50.5380387 +10:02:06.249290" 40 > mask1.reg
python3 deimosfootprint.py "00:03:52.2653125 +10:01:40.859374" 40 > mask1.reg
python3 deimosfootprint.py "00:03:52.2653125 +10:01:40.859374" 220 > mask1_1.reg
python3 deimosfootprint.py "00:03:52.6853271 +10:04:00.687612" -140 > mask1_2.reg
python3 deimosfootprint.py "00:04:02.1329928 +10:03:27.409098" 40 > 0003/mask1_3.reg

Load SDSS catalog and apply filter
	(${rmag}<17 && ${rmag}>15 && ${cl}==6) {draw}
	x check SDSS navigator!
		x the guide star is too bright according to PS.
	for alignment stars:
		(${rmag}<20 && ${rmag}>15 && ${cl}==6) {draw}
	x Do galaxies work as alignment and guide? No




Export filtered catalog.

PS catalog download
	00:03:52.6853271 +10:04:00.687612
	x Stacked or mean catalog?
		x I think it should be stacked. Mean returns too many entries!
			x Stacked has gaps. It has to be mean.
	Remember to establish conditions, especially nDetections>=2
		Also rMeanKronMag>-990
			THESE ARE VERY IMPORTANT. Even if it results in unmatched sources, we don't want to target spurious detections!!

MAST zphot SQL query
	see jupyter notebook


prioritize.py
	use jupyter notebook to calculate positions in deg of the mask center.
	export ra,dec,rmag of align/guide stars directly from Aladin
	x only one guide star? Yes.
	x are other slit_pa values acceptable? Output has 3 different values.
		x Between -90 and 90 deg.

Preparing known redshifts
	NED cone search 10' radius
	Redshift Flag: like 's%' (selects spectroscopic) or sls (better b/c only uses spectral lines (no weird methods))

x 2nd mask: make file like archivalz from output to exclude from target list
x make target catalog for aladin instead of region file
x make catalog for archivalz
x make catalogs for selected and non-selected
- implement improvements suggested by David in the google doc
	- implement penalty for off-axis
x bogus selected targets
	x check PS catalogs (photo and zphoto)
		x bogus targets have low nDetections
	x remove (by hand?)
		x maybe using nDetections would work
			x use nDetections=10
x how to get full PS catalog in the region?
	x use api in jupyter notebook
x ask for output folder instead of redirecting output.
x version control
x dispersion direction?
	x always perpendicular to maskPA (doesn't depend on slitPA)
x how to put ps_api library in path?
x implement exclude_manually (input file already changed)

*******
2nd attempt with different PA

python3 deimosfootprint.py "00:03:48.7225972 +10:01:48.665376" 150 > 0003/mask2_1.reg
python3 deimosfootprint.py "00:03:48.7225972 +10:01:48.665376" -30 > 0003/mask2_2.reg
python3 deimosfootprint.py "00:03:45.5025197 +10:04:27.708330" -30 > 0003/2/mask2_3.reg


python3 prioritize.py file.json > 2/targets.txt
python3 prioritize.py 2/file.json > 2/targets.txt



*******
Starting over on RMJ0003/

use david's archivalz.txt file
	convert david's output into csv

phot_1.csv: nDetections>1, rmag>-990
phot_2.csv: nDetections unconstrained, rmag>-990
phot_3.csv (?): unconstrained
phot.cvs: nDetections>10

MASK1
python3 deimosfootprint.py "00:03:48.8888534 +10:04:10.737999" -140 > RMJ0003/1/mask1.reg
python3 prioritize.py RMJ0003 1


MASK2
python3 deimosfootprint.py "00:03:50.0443707 +10:04:22.110113" -140 > RMJ0003/2/mask1.reg
change 2/input.json to read output file
python3 prioritize.py RMJ0003 2


grep -v diamond RMJ0003A.reg >RMJ0003A-safe.reg


____________________________________________________________________________________
RMJ2321 (I'll be using Faik's region file to place the mask where he wants.)

Run the SpeX PARALLACTIC ANGLE CALCULATOR.
Parallactic Angle =   -85.3380966      or    94.6619034      or    274.661896      degrees

MASK A
Create a mask region somewhere (RA and Dec can be the nominal coordinates for the cluster)  by typing: 
python3 deimosfootprint.py "23:21:09.5327035 +29:12:52.921937" 45.5 > RMJ2321/1/mask1.reg. Load the region file into Aladin. On the stack panel (right-hand side), click on the Drawing plane and select all objects. Now you can move the mask to the position you want. The cross in the middle of a chip gap is the central position; click on it to get the new coordinates. Now create a new mask. You can try adjusting the angle as well.
python3 deimosfootprint.py "23:21:08.3381708 +29:13:00.035871" 45 > RMJ2321/1/mask1.reg
Load the new mask into Aladin and inspect it.

python3 prioritize.py RMJ2321 1

process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ2321/1/dsim/

MASK B
python3 prioritize.py RMJ2321 2
	changed the input file to exclude slits from the first mask.

MASK C
python3 deimosfootprint.py "23:21:09.5327035 +29:12:52.921937" 130 > RMJ2321/3/mask1.reg
python3 deimosfootprint.py "23:20:50.8332914 +29:12:35.636413" 130 > RMJ2321/3/mask1.reg
python3 deimosfootprint.py "23:20:50.8332914 +29:12:35.636413" 125 > RMJ2321/3/mask1.reg

python3 prioritize.py RMJ2321 3

python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ2321/3/dsim/

(dsim Final Center: 23:20:50.835 +29:12:35.63)
____________________________________________________________________________________
RM J001938.7+033557.3

00:19:38.7 +03:35:57
0.28
5550
-67

MASK A

python3 deimosfootprint.py "00:19:36.6351588 +03:36:14.928274" -30 > RMJ0019/1/mask1.reg
python3 deimosfootprint.py "00:19:36.6351588 +03:36:14.928274" -5 > RMJ0019/1/mask1.reg
python3 deimosfootprint.py "00:19:40.3797821 +03:37:04.642511" -5 > RMJ0019/1/mask1.reg
python3 deimosfootprint.py "00:19:40.3797821 +03:37:04.642511" 175 > RMJ0019/1/mask1.reg
python3 deimosfootprint.py "00:19:33.7387987 +03:38:32.861753" 175 > RMJ0019/1/mask1.reg
python3 deimosfootprint.py "00:19:34.2050580 +03:38:26.680717" 175 > RMJ0019/1/mask1.reg
python3 prioritize.py RMJ0019 1
guiding star is not very good. Moved to PA175. 

Starting over:
python3 deimosfootprint.py "00:19:39.5575141 +03:38:26.682746" -5 > RMJ0019/1/mask1.reg
python3 deimosfootprint.py "00:19:40.4242931 +03:38:26.681976" -5 > RMJ0019/1/mask1.reg
python3 prioritize.py RMJ0019 1
added special targets

special[1,2,3,4] not selected in mask 1 (2 and 4 very important). Increase priority for mask 2.

run on iron:
python3 /Users/dwittman/Observing/Keck/Tools/dsim2regions.py ./ RMJ0019A.fits --slits --targets --pointing --guider --mask RMJ0019A.reg
then locally:
grep -v diamond RMJ0019A.reg >RMJ0019A-safe.reg
sed 's/diamond//' RMJ0019A.reg >RMJ0019A-safe.reg
sed 's/diamond//' RMJ0019B.reg >RMJ0019B-safe.reg


MASK B

python3 deimosfootprint.py "00:19:40.4621979 +03:38:16.089861" -5 > RMJ0019/2/mask1.reg
python3 prioritize.py RMJ0019 2
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ0019/2/dsim/

***** Trying again with new strong lens features selected by David.
python3 prioritize.py RMJ0019 1
python3 prioritize.py RMJ0019 2
Ready.

____________________________________________________________________________________
RM J021952.2+012952.2

MASK A
python3 deimosfootprint.py "02:19:50.9328810 +01:29:00.838056" 0 > RMJ0219/1/mask1.reg
python3 deimosfootprint.py "02:19:50.9328810 +01:29:00.838056" 180 > RMJ0219/1/mask1.reg
python3 deimosfootprint.py "02:19:51.9143505 +01:29:04.389861" 180 > RMJ0219/1/mask1.reg

faik
	angles are wrong
	not enough targets

python3 prioritize.py RMJ0219 1
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ0219/1/dsim/
sed 's/diamond//' RMJ0219A.reg >RMJ0219A-safe.reg

MASK B
python3 deimosfootprint.py "02:19:46.8252639 +01:28:36.039735" 180 > RMJ0219/2/mask1.reg
python3 deimosfootprint.py "02:19:51.9143505 +01:29:04.389861" 210 > RMJ0219/2/mask1.reg
python3 deimosfootprint.py "02:19:48.4058269 +01:29:01.546517" 210 > RMJ0219/2/mask1.reg
python3 prioritize.py RMJ0219 2
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ0219/2/dsim/
sed 's/diamond//' RMJ0219B.reg >RMJ0219B-safe.reg
____________________________________________________________________________________
A384

MASK A
python3 deimosfootprint.py "02:48:02.0267519 -02:17:13.178614" -120 > A384/1/mask1.reg
python3 prioritize.py A384 1
sed 's/diamond//' A384A.reg >A384A-safe.reg
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/A384/1/dsim/

MASK B
python3 deimosfootprint.py "02:48:03.2952000 -02:15:57.348000" -120 > A384/2/mask1.reg
python3 prioritize.py A384 2
sed 's/diamond//' A384B.reg >A384B-safe.reg
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/A384/2/dsim/
python3 deimosfootprint.py "02:48:06.762 -02:15:27.348000" -120 > A384/2/dsim/mask1_check.reg

Starting over mask B in folder 3/
	One alignment star wouldn't get milled.
python3 deimosfootprint.py "02:48:06.762 -02:15:27.348000" -120 > A384/3/mask1.reg
python3 deimosfootprint.py "02:48:19.5842628 -02:15:23.536485" 60 > A384/3/mask2.reg
python3 deimosfootprint.py "02:48:19.7286089 -02:15:53.812540" 60 > A384/3/mask2.reg

python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/A384/3/dsim/

"exclude_target": ["0264883804", "0411641748"]
	didn't work to select what I wanted

____________________________________________
RMJ0109

MASK A
python3 deimosfootprint.py "01:09:32.5752000 +33:03:16.898400" 45 > RMJ0109/1/mask1.reg
python3 deimosfootprint.py "01:09:42.2955383 +33:04:01.370649" 225 > RMJ0109/1/mask2.reg
python3 deimosfootprint.py "01:09:34.7153586 +33:04:53.975500" 225 > RMJ0109/1/mask2.reg

sed 's/diamond//' RMJ0109A.reg >RMJ0109A-safe.reg
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ0109/1/dsim/

MASK B
python3 deimosfootprint.py "01:09:19.7387941 +33:01:10.636678" 225 > RMJ0109/2/mask1.reg
sed 's/diamond//' RMJ0109B.reg >RMJ0109B-safe.reg
python3 process_dsim_output.py /Users/rodrigo/google_drive/research/deimos/deimos0923_mask_design/RMJ0109/2/dsim/

Faik:
	SlitPA could be better.
	Alignment stars not well positioned. One of them looks completely wrong.


MASK B
Faik's mask B looks wrong.
Not done yet.

____________________________________________________________________________________
ask david
	dsim mask position
	which strong lensing features
	magnitude of special targets
	5 arcsec slits?
	orientation of mask B for RMJ2321
	faik
		catalog
		align
		2nd mask
	




